<div class="current-stock-container">
  <p-card header="Stock Report">
    <div class="stock-container">
      <!-- Camp Selection Section -->
      <div class="selection-section">
        <div class="field">
          <label for="camp">Select Camp</label>
          <p-dropdown 
            id="camp" 
            [(ngModel)]="selectedCampId" 
            [options]="campOptions" 
            optionLabel="label" 
            optionValue="value"
            placeholder="Select Camp to View Stock Report" 
            [showClear]="true"
            [disabled]="loading"
            (onChange)="onCampChange()"
            (onClear)="clearSelection()"
            [appendTo]="'body'"
            class="w-full">
          </p-dropdown>
          <small *ngIf="loading" class="loading-text">Loading camps...</small>
          <small *ngIf="errorMessage" class="error-text">{{ errorMessage }}</small>
        </div>
      </div>

      <!-- Stock Table Section -->
      <div class="table-section" *ngIf="selectedCampId && filteredStockItems.length > 0">
        <div class="table-header">
          <h3>Stock Report Details</h3>
          <div class="total-quantity">
            <span class="label">Total Quantity:</span>
            <span class="value">{{ getTotalQuantity() }}</span>
          </div>
        </div>

        <p-table [value]="filteredStockItems" [paginator]="true" [rows]="10" [showCurrentPageReport]="true"
          currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
          [rowsPerPageOptions]="[10, 25, 50]">
          <ng-template pTemplate="header">
            <tr>
              <th>Medicine Name</th>
              <th>Medicine Type</th>
              <th>Quantity</th>
              <th>Batch No</th>
              <th>Expiry Date</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-item>
            <tr>
              <td>{{ item.medicine_name }}</td>
              <td>{{ item.medicine_type }}</td>
              <td>
                <span class="quantity-badge">{{ item.quantity }}</span>
              </td>
              <td>{{ item.batch_no || 'N/A' }}</td>
              <td>{{ item.exp_date ? (item.exp_date | date:'yyyy-MM-dd') : 'N/A' }}</td>
            </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="5" style="text-align: center; padding: 20px;">No stock found for selected camp.</td>
            </tr>
          </ng-template>
        </p-table>
      </div>

      <!-- Empty State -->
      <div class="empty-state" *ngIf="!selectedCampId">
        <p>Please select a camp from the dropdown to view its stock report.</p>
      </div>

      <div class="empty-state" *ngIf="selectedCampId && filteredStockItems.length === 0">
        <p>No stock available for the selected camp.</p>
      </div>
    </div>
  </p-card>
</div>

